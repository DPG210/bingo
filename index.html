<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bingo Jugador</title>
    <script src="https://www.gstatic.com/firebasejs/9.1.3/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.1.3/firebase-database-compat.js"></script>
    <style>
        body { font-family: sans-serif; background: #1a1a2e; color: white; text-align: center; }
        #nick-screen { position: fixed; inset: 0; background: #1a1a2e; display: flex; flex-direction: column; align-items: center; justify-content: center; z-index: 100; }
        input { padding: 15px; border-radius: 10px; margin-bottom: 20px; width: 80%; max-width: 300px; }
        .carton { display: grid; grid-template-columns: repeat(9, 1fr); gap: 5px; max-width: 500px; margin: auto; }
        .cell { background: #ecf0f1; color: #2c3e50; aspect-ratio: 1/1; display: flex; align-items: center; justify-content: center; font-weight: bold; border-radius: 5px; }
        .marked { background: #e74c3c !important; color: white !important; }
        .btn { padding: 15px 25px; border: none; border-radius: 25px; color: white; font-weight: bold; margin: 10px; cursor: pointer; }
    </style>
</head>
<body>
    <div id="nick-screen">
        <h2>Introduce tu Nick</h2>
        <input type="text" id="nick-input" placeholder="Tu nombre...">
        <button class="btn" style="background: #27ae60" onclick="entrar()">ENTRAR</button>
    </div>

    <h1>SALA: <span id="sala-id">---</span></h1>
    <div id="carton-container" class="carton"></div>

    <div style="margin-top: 20px;">
        <button class="btn" style="background: #2980b9" onclick="notificar('LÍNEA')">¡LÍNEA!</button>
        <button class="btn" style="background: #27ae60" onclick="notificar('BINGO')">¡BINGO!</button>
    </div>

    <script>
        const firebaseConfig = { databaseURL: "https://bingov3-1ec3a-default-rtdb.europe-west1.firebasedatabase.app/" };
        firebase.initializeApp(firebaseConfig);
        const db = firebase.database();

        let nick = "";
        const idSala = new URLSearchParams(window.location.search).get('sala');
        document.getElementById('sala-id').innerText = idSala;

        function entrar() {
            nick = document.getElementById('nick-input').value.trim();
            if(nick) {
                document.getElementById('nick-screen').style.display = 'none';
                generarCarton();
            }
        }

        function notificar(tipo) {
            if(confirm(`¿Cantar ${tipo}?`)) {
                // Envía el Nick y el tipo de premio a Firebase
                db.ref(`Salas/${idSala}/Notificaciones`).set({
                    msg: `¡${nick} ha cantado ${tipo}!`,
                    t: Date.now()
                });
            }
        }

        function generarCarton() {
            // ... Aquí usa tu lógica de generación de 15 números y 5 por fila
            // Al crear los divs de las celdas, añade: div.onclick = () => div.classList.toggle('marked');
        }
    </script>
</body>
</html>